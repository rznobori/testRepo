ファイル名:<br>
<input id="edit_04_name" style="width:100%;  margin:0px 0px 5px 0px;" value="myfile.txt" /><br>
テキスト:<br>
<textarea id="edit_04_text" style="width:100%; height:150px; margin:0px 0px 5px 0px;">保存テスト</textarea><br>
<input type = "button" id="button_04_download" style="width:100%; height:50px; margin-bottom:10px;" value="ダウンロードを開始する"><br>
結果:<br>
<input id="edit_04_result" style="width:100%; margin:0px 0px 5px 0px;" disabled />

<script type="text/javascript">
<!--
// 匿名関数内で実行
(function (){

	// 各エレメントを取得
	var element_name = document.getElementById("edit_04_name");
	var element_text = document.getElementById("edit_04_text");
	var element_result = document.getElementById("edit_04_result");
	var element_download = document.getElementById("button_04_download");

	// アンカー
	var anchor = document.createElement("a");

	// ------------------------------------------------------------
	// サポート状況
	// ------------------------------------------------------------
	if(!window.File){
		element_result.value = "File クラスに対応していません。";
		return;
	}
	if(!window.FileReader){
		element_result.value = "FileReader クラスに対応していません。";
		return;
	}
	if(anchor.download === undefined){
		element_result.value = "download 属性に対応していません。";
		return;
	}

	// ------------------------------------------------------------
	// クリックしたときに実行されるイベント
	// ------------------------------------------------------------
	element_download.addEventListener("click" , function(e){

		// ------------------------------------------------------------
		// Blob オブジェクトを作成（UTF-8 形式のプレーンテキスト）
		// ------------------------------------------------------------
		var blob = new Blob([element_text.value] , {type:"text/plain"});

		// ------------------------------------------------------------
		// FileReader オブジェクトを生成
		// ------------------------------------------------------------
		var file_reader = new FileReader();

		// ------------------------------------------------------------
		// 読み込み成功時に実行されるイベント
		// ------------------------------------------------------------
		file_reader.onload = function(e){

			// ------------------------------------------------------------
			// アンカーの設定
			// ------------------------------------------------------------
			// ターゲットを設定
			anchor.target = "_blank";

			// ダウンロードするファイルを Data URI Scheme 文字列で指定
			anchor.href = file_reader.result;

			// デフォルトのファイル名を指定
			anchor.download = element_name.value;

			// ------------------------------------------------------------
			// ダウンロードを開始する
			// ------------------------------------------------------------
			document.body.appendChild(anchor);
			anchor.click();
			anchor.parentNode.removeChild(anchor);

			element_result.value = file_reader.result;

		};

		// ------------------------------------------------------------
		// 読み込みを開始する（Data URI Scheme 文字列を得る）
		// ------------------------------------------------------------
		file_reader.readAsDataURL(blob);
	});

})();
//-->
</script>